<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script type="text/javascript">
        function disableBack() { window.history.forward(); }
        setTimeout("disableBack()", 0);
        window.onunload = function () { null };
    </script>
</head>

<style>
    #rat {
        opacity: 0;
    }

    .start_btn button {
        font-size: 25px;
        font-weight: 500;
        color: #007bff;
        padding: 15px 30px;

        border-radius: 5px;
        background: #fff;

    }




    .info_box {
        width: 540px;
        background: #fff;
        border-radius: 5px;

        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .activeInf {
        opacity: 1;
        pointer-events: fill;
    }



    .quiz_box {
        margin-left: 50px;
        width: 100% !important;
        background: #fff;
        border-radius: 5px;

        opacity: 0;


    }

    .activeQuiz {
        opacity: 1;
    }


    .result_box {
        opacity: 0;

    }

    .showresultbox {
        opacity: 1;
    }


    .activeResult {
        margin-top: 0px;
        margin-left: 0px;
        opacity: 1;
    }


    .quiz_box header .timer {
        margin-left: 40px;
        color: #004085;
        background: #cce5ff;
        border: 1px solid #b8daff;
        height: 45px;
        padding: 0 8px;
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 145px;
    }

    section {
        display: inline-block;
        padding: 25px 30px 20px 30px;
        background: #fff;
    }

    section .que_text {
        font-size: 25px;
        font-weight: 600;
        width: 80% !important;
    }

    section .option_list {
        margin-top: 30px;
        padding: 20px 0px;
        display: block;
    }

    section .option_list .option {
        background: aliceblue;
        border: 1px solid #84c5fe;
        border-radius: 5px;
        padding: 8px 15px;
        font-size: 17px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    section .option_list .option:last-child {
        margin-bottom: 0px;
    }

    section .option_list .option:hover {
        color: #004085;
        background: #cce5ff;
        border: 1px solid #b8daff;
    }



    section .option_list .option.incorrect {
        color: #721c24;
        background: #f8d7da;
        border: 1px solid #f5c6cb;
    }

    section .option_list .option.disabled {
        pointer-events: none;
    }

    section .option_list .option .icon {
        height: 26px;
        width: 26px;
        border: 2px solid transparent;
        border-radius: 50%;
        text-align: center;
        font-size: 13px;
        pointer-events: none;
        transition: all 0.3s ease;
        line-height: 24px;
    }

    .green {

        background-color: red !important;
        font-family: 'Courier New', Courier, monospace;
        height:auto;
        width:80%
    }

    .red {
        font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        background-color: rgb(49, 153, 63);
        height:auto;
        width:80%
    }

    .option {
        width: 300px;
        height: 50px;
        border: 1px solid #84c5fe;
        border-radius: 5px;
        padding: 8px 15px;
        font-size: 17px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s ease;

        align-items: center;
        justify-content: space-between;

    }

    .solution {
        width: 550px;
        background: #fff;
        border-radius: 5px;


    }

    .solution_btn {
        opacity: 0;
    }

    .ff {
        font-size: 25px;
        font-weight: 400;
        width: 100% !important;
        font-family: 'Courier New', Courier, monospace;
    }

    .showsolutionbtn {
        opacity: 1;
    }



    .ll {
        opacity: 1
    }

    .finishexam {
        opacity: 0;
    }

    .activatefinish {
        opacity: 1;
    }

    .button1 {
        opacity: 0;
    }

    .activatebutton1 {
        opacity: 1;
    }

    .fg {
        opacity: 0;
    }

    .Myreg {
        opacity: 0;

    }

    .Myage {
        opacity: 0;
    }

    .marks {
        opacity: 0;
    }

    .quiz {
        opacity: 0;
    }

    .activemarks {
        opacity: 1;

    }

    .activereg {
        opacity: 1;
    }

    .activequiz {
        opacity: 1;
    }

    .activeage {
        opacity: 1;
    }

    .button2 {
        opacity: 0;

    }

    .button3 {
        opacity: 0;

    }

    .activebutton2 {
        opacity: 1;
    }

    .activebutton3 {
        opacity: 1;
    }

    .solutions {
        height: auto;
    }
    .palletes{
          display: inline-block;
       margin-top: 100px;
        margin-left: 70px;

    }

    .pallette1 {
        display: inline-block;
        float: right;
        width: 200px;
        height: auto;
        border: 2px solid black;
        position: absolute;
        overflow-y: scroll;

    }

    .pallette2 {
        display: inline-block;
       
        width: 200px;
        height: 400px;
        border: 2px solid black;
        position: absolute;
        overflow-y: scroll;

    }

    .pallette3 {
        display: inline-block;
       
        width: 200px;
        height: 400px;
        border: 2px solid black;
        position: absolute;
        overflow-y: scroll;
    }

    .pallette4 {
        display: inline-block;
      

        width: 200px;
        height: 400px;
        border: 2px solid black;
        position: absolute;
        overflow-y: scroll;

    }

    #button5 {
        height: 50px;
        width: 150px;
    }

    #button6 {
        height: 50px;
        width: 100px;
    }

    #button7 {
        height: 50px;
        width: 100px;
    }

    #button8 {
        height: 50px;
        width: 100px;
    }



    #ty {
        margin-top: 15px;
        margin-left: 40px;
        height: 150px;
        width: 500px;
    }

    #passimg {
        height: 300px;
        width: 500px;
    }

    .myimgtag {
        margin-left: 30px;
        margin-top: 20px;
        height: 280px;
        width: 70% !important;
    }

    .myimgtag[src=""] {
        display: none;
        width: 70% !important;
    }

    .passimg[src=""] {
        display: none;
    }

    .hu {
        display: none;
    }

    .new1 {
        display: flex;
        flex-direction: row;
        width: 90%
    }

    @media only screen and (max-width: 600px) {




        .new1 {
            display: flex;
            flex-direction: column;
            width: 90%
        }

    }
    .blue{
         background-color: red !important;
        font-family: 'Courier New', Courier, monospace;

        height:auto;
        width:80%
    }
</style>

<body>
    <br>
    <br>
    <div id="mysections" style="margin-left:40px">
    </div>
    <div class="namequiz">{{mdata}}</div>
    <div class="mycontainer new1">
        <div class="quiz_box" id="myquiz" style=" width:100% ">
            <header>
                <div class="timer" style="margin-top:40px;margin-bottom:20px">
                    <div class="time_left_txt">Time Left</div>
                    <div class="timer_sec">15</div>
                </div>
                {{!-- <div class="time_line"></div> --}}
            </header>
            <section id="mysect" style="width: 100%;">
                <div id="passtop"></div>
                                <div id="passtop1"></div>

                <div class="passage" id="passage" style="width:90%"></div>
                <img src="" alt="" class="passimg" id="passimg">
                <div class="messagetop"id="messagetop"></div>
                <img src="" alt="" id="queimg">
                <div class="que_text bg-light border " style="display:flex; width:100%">
                    <!-- Here I've inserted question from JavaScript -->
                </div>
                <img src="" class="myimgtag" id="myimgtag" alt="">
                <div class="option_list" style="width:70%">
                    <!-- Here I've inserted options from JavaScript -->
                </div>
                <div id="integerquestion" style="display:none">
                    <label for="exampleInputEmail1">Your answer in integer</label><br>
                    <input type="number" id="myintegerans" style="margin-left:100px;width:200px"
                        aria-describedby="emailHelp" placeholder="Enter Answercode" name="answercode3">
                </div>
            </section>
            <!-- footer of Quiz Box -->
            <footer id="myfoot" style="margin-left:40px width:100%;">
                <div class="total_que">
                    <!-- Here I've inserted Question Count Number from JavaScript -->
                </div>
                <button class="next_btn">Next</button>
                <button class="prev_btn">prev</button>
                <button style="display:none" class="integer_btn">integer submit</button>
                <button class="clearans_btn">clear</button>
                <button class="submit_btn">submit</button>
            </footer>
        </div>
        <div class="palletes" style="width:50%">
            <div class="pallette1">
            </div>
            <div class="pallette2">
            </div>
            <div class="pallette3">
            </div>
            <div class="pallette4">
            </div>
        </div>
    </div>
    </div>
    <br><br>
    <!-- Result Box -->
    <div class="result_box">
        <div class="icon">
            <i class="fas fa-crown"></i>
        </div>
        {{!-- <div class="complete_text">You've completed the exam . Kindly submit your responses</div> --}}
        <div class="score_text">
            <!-- Here I've inserted Score Result from JavaScript -->
        </div>
        <div class="buttons">
            <!--- <button class="restart">Replay Quiz</button>
            <button class="quit">Quit Quiz</button>-->
        </div>
    </div>
    <div class="solution"></div>
    <form action="/newquiz4result" method="POST" class="myform" id="myform" enctype="multipart/form-data">
        <input type="hidden" name="na" value={{table2}} id="quizname">
        <input type="hidden" name="registation" value={{reg}} id="regno"><br>
        <span>Your Score is: </span><input type="text" readonly name="marks" id="marks"><br>
        <input type="hidden" name="studentname" value={{name2}} id="studentname"><br>
        <button type="submit" style="width:300px;height:40px" class="btn btn-primary">see solutions</button>
    </form>
    <form action="/newresultmulti" method="POST" class="myform1" id="myform1">
        <input type="hidden" name="myquiz" value={{table2}} id="quizname">
        <input type="hidden" name="name" value={{name2}} id="studentname"><br>
        <input type="hidden" name="examname" value="Highlevelexam"><br>
        <button type="submit" style="width:300px;height:40px;display:none" class="btn btn-primary">submit your
            responses</button>
    </form>
    <div id="rat" style="display: none;">{{userd}}</div>

    <script>
        let html = ""
        let myquestions = []
        let nn = 0
        let p = 0
        let g = 0
        let Mydata;
        let tm = 0
        let rat = document.getElementById("rat").innerText
        console.log(rat)
        Mydata = JSON.parse(rat)

        let option2 = []
        for (let i = 0; i < Mydata.length; i++) {
            option2.push(Mydata[i].option2)
        }
        const quiz_box = document.querySelector(".quiz_box");
        const integerans = document.getElementById("myintegerans");
        const integerquestion = document.getElementById("integerquestion");
        const namequiz = document.querySelector(".namequiz");
        const integerbtn = document.querySelector(".integer_btn");
        const result_box = document.querySelector(".result_box");
        const option_list = document.querySelector(".option_list");
        const time_line = document.querySelector("header .time_line");
        const timeText = document.querySelector(".timer .time_left_txt");
        const timeCount = document.querySelector(".timer .timer_sec");
        const solution = document.querySelector(".solution")
        const button1 = document.querySelector(".button1")
        const solution_btn = document.querySelector('.solution_btn')
        const prev_btn = document.querySelector(".prev_btn")
        const clear_btn = document.querySelector(".clearans_btn")
        const myage = document.querySelector(".Myage")
        const myreg = document.querySelector(".Myreg")
        const button2 = document.querySelector(".button2")
        const button3 = document.querySelector(".button3")
        // const imgtag = document.querySelector(".imgtag")
        const Myresult = document.querySelector(".Myresult")
        const submitbtn = document.querySelector(".submit_btn")
        const myresponses = document.querySelector(".myresponses")
        const pallette1 = document.querySelector(".pallette1")
        const pallette2 = document.querySelector(".pallette2")
        const pallette3 = document.querySelector(".pallette3")
        const pallette4 = document.querySelector(".pallette4")
        const button5 = document.getElementById('button5')
        const button6 = document.getElementById('button6')
        const button7 = document.getElementById('button7')
        const button8 = document.getElementById('button8')
        const myimgtag = document.querySelector(".myimgtag")
        const mypasstag = document.getElementById('passage')
        const mypassimg = document.getElementById('passimg')
        const quiz = document.querySelector(".quiz")
        let finishexam = document.querySelector('.finishexam')
        quiz_box.classList.add("activeQuiz");
        namequiz.style.display = "none"
        let timeValue = 60;
        let que_count = 0;
        let que_numb = 1;
        // let userScore1 = 0;
        let counter;
        let counterLine;
        let widthValue = 0;
        let html1 = ``
        let no1 = parseInt(Mydata[0].qsection)
        function section1() {
            for (let i = 0; i <= Mydata[0].qsection - 1; i++) {
                html1 += `<input type="submit" value=${i + 1} id=${i} class="pots" onclick="changeoption(this.id)" style="height:40px;width:40px;">`
            }
            pallette1.innerHTML = html1
        }

        section1()
        //let no2 = no1;
     //  let no3 = no1;
      // let no4 = no1;
//---------------------------------------------------------------------------------------------
      //  if (Mydata[no1]) {
            let no2 = parseInt(Mydata[no1]?.qsection)
                                    console.log(no1)

                        console.log("value of no2"+" "+no2+no1)

        //}
      //  if (Mydata[no2 + no1]) {

            let no3 = parseInt(Mydata[no2 + no1]?.qsection)
                                    console.log(no3)

       // }
    //    if (Mydata[no1 + no2 + no3]) {
                                   // console.log(Mydata[no2 + no1+no3]?.qsection)

            let no4 = parseInt(Mydata[no2 + no1 + no3]?.qsection)
      //  }
      console.log("the ranges are")
console.log(no1+no2+no3)
console.log(no1+no2+no3+no4)

      //---------------------------------------------------------------------------
        let html2 = ``
        function section2() {
            if (Mydata[no1]) {
                for (let i = parseInt(no1); i <= (parseInt(no1) + parseInt(no2))- 1; i++) {
                    html2 += `<input type="submit" value=${i + 1} id=${i} class="pots" onclick="changeoption(this.id)" style="height:40px;width:40px;">`
                }
            }
            else {
                html2 = "";
            }
            pallette2.innerHTML = html2
        }
        section2()
        let html3 = ``
        function section3() {
            if (Mydata[no2 + no1]) {
                for (let i = (no1 + no2); i <= (no1 + no2 + no3) - 1; i++) {
                    html3 += `<input type="submit" value=${i + 1} id=${i} class="pots" onclick="changeoption(this.id)" style="height:40px;width:40px;">`
                }
            }
            else {
                html3 = ""
            }
            pallette3.innerHTML = html3
        }

        section3()
        let html4 = ``
        function section4() {
            if (Mydata[no1 + no2 + no3]) {

                for (let i = (no1 + no2 + no3); i <= (no1 + no2 + no3 + no4) - 1; i++) {
                    html4 += `<input type="submit" value=${i + 1} id=${i} class="pots" onclick=" changeoption(this.id)" style="height:40px;width:40px;">`

                }
            }
            else {
                html4 = ""
            }
            pallette4.innerHTML = html4
        }
        section4()


        const next_btn = document.querySelector("footer .next_btn");
        const bottom_ques_counter = document.querySelector("footer .total_que");
        changed(0)
        function changed(kk) {

            document.getElementById('myform').style.display = "none"
             let myanswers = JSON.parse(localStorage.getItem("myquestions"))

            que_count = kk

        showQuetions(kk)

                        
            let html = ``;
            if (Mydata[0].section) {
                html = ` <button id="button5"   name="button1"  style="height:30px;width:100px;" onclick="changed(0)">${Mydata[0].section}</button>`
            }

            if (typeof (Mydata[no1]) != 'undefined') {
                html += `<button id="button6"  name="button1" style="height:30px;width:100px;" onclick="changed(${no1 + 1})">${Mydata[no1].section}</button>`
            }


            if (typeof (Mydata[no2 + no1]) != 'undefined') {
                html += `<button id="button7"  name="button2" style="height:30px;width:100px;"onclick="changed(${no1 + no2 + 1})">${Mydata[no2 + no1].section}</button>`

            }

            if (typeof (Mydata[no3 + no1 + no2]) != 'undefined') {
                html += `<button id="button8"  name="button3" style="height:30px;width:100px;"onclick="changed(${no1 + no2 + no3 + 1})">${Mydata[no3 + no1 + no2].section}</button>`
            }
            const button5 = document.getElementById('button5')
            const button6 = document.getElementById('button6')
            const button7 = document.getElementById('button7')
            const button8 = document.getElementById('button8')
            document.getElementById("mysections").innerHTML = html
            function showpallet() {

                if (que_count >= 0 && que_count <= no1 - 1) {
                    pallette2.style.display = "none"
                    pallette3.style.display = "none"
                    pallette1.style.display = "block"
                    pallette4.style.display = "none"
                }
                if (que_count >= no1 && que_count <= (no1 + no2) - 1) {
                    pallette2.style.display = "block"
                    pallette1.style.display = "none"
                    pallette3.style.display = "none"
                    pallette4.style.display = "none"
                }
                if (que_count >= (no1 + no2) && que_count <= (no1 + no2 + no3) - 1) {
                    pallette3.style.display = "block"
                    pallette2.style.display = "none"
                    pallette1.style.display = "none"
                    pallette4.style.display = "none"
                }
                if (que_count >= no1 + no2 + no3 + 1 && que_count <= (no1 + no2 + no3 + no4) - 1) {
                    pallette4.style.display = "block"
                    pallette2.style.display = "none"
                    pallette1.style.display = "none"
                    pallette3.style.display = "none"
                }
            }
            showpallet()
            showQuetions(que_count)
            next_btn.onclick = () => {
                let a = []
                let myanswers = JSON.parse(localStorage.getItem("myquestions"))
                if ((que_count < Mydata.length - 1)||que_count==1) {

                    que_numb = que_count + 1
                    que_count++; //increment the que_count value
                    que_numb++; //increment the que_numb value
                    showQuetions(que_count); //calling showQestions function
                    queCounter(que_numb); //passing que_numb value to queCounter
                   // g = myanswers[que_numb - 1]
                   g=myanswers[que_count]
                    const option = option_list.children[0].querySelectorAll(".option");
                    showpallet()
                    if (Array.isArray(myanswers[que_count])) {
                        for (let i = 0; i < myanswers[que_count].length; i++) {
                            a.push(myanswers[que_count][i]);
                            option[a[i]].classList.add('green')
                            console.log("dfgdsg3")
                        }
                    }
                    else {
                        if (option[g]) {


                            option[g].classList.add('green')
                        }
                    }
                    timeText.textContent = "Time Left"; //change the timeText to Time Left
                    next_btn.classList.remove("show"); //hide the next button
                } else {

                                                            console.log("question is 1")

                    que_numb = 1
                    que_count = 0
                    showQuetions(que_count); //calling showQestions function
                    queCounter(que_numb); //p
                    showpallet()
                                        g = myanswers[0]
                            console.log(g)
                    const option = option_list.children[0].querySelectorAll(".option");

                                         if (option[g]) {
                            option[g].classList.add('green')
                        }
                }
            }

            prev_btn.onclick = () => {
                let myanswers = JSON.parse(localStorage.getItem("myquestions"))
                let b = [];
                if (que_count < Mydata.length) {
                    que_numb = que_count + 1
                    que_count--; //increment the que_count value
                    que_numb--; //increment the que_numb value
                    if (que_numb <=0) {
                        que_count = Mydata.length - 1;
                        que_numb = Mydata.length
                    }
                    showpallet()
                    showQuetions(que_count); //calling showQestions function
                    queCounter(que_numb);
                   // g = myanswers[que_numb - 1]
                                      g=myanswers[que_count]

                    const option = option_list.children[0].querySelectorAll(".option");
                    if (Array.isArray(myanswers[que_count])) {
                        for (let i = 0; i < myanswers[que_count].length; i++) {
                            b.push(myanswers[que_count][i]);
                            option[b[i]].classList.add('green')

                        }

                    }
                    else {
                        if (option[g]) {
                            option[g].classList.add('green')
                        }
                    }
                }
            }

            clear_btn.onclick = () => {
                const index = myquestions.indexOf(que_count);
                myquestions.splice(index - 1, 1)
                console.log(myquestions)
                let b = JSON.stringify(myquestions)
                localStorage.setItem("myquestions", b)
            }

            submitbtn.onclick = () => {
                clearInterval(counter)
                showResult()
                document.getElementById('myform').style.display = "block"
                document.getElementById('mysect').style.display = "none"
                document.getElementById('myfoot').style.display = "none"
                document.getElementById('myquiz').style.display = "none"
                document.getElementById("mysections").style.display = "none"
                document.querySelector(".palletes").style.display = "none"
                option_list.style.display = "none"
                integerquestion.style.display = 'none'
                integerbtn.style.display = "none"
            }

            //--------------------------------------------------------------------------------------------------
            // getting questions and options from array
            function showQuetions(que_count) {
                let que_tag = ""
                const que_text = document.querySelector(".que_text");
                if ((Mydata[que_count].type == "multichoice") || (Mydata[que_count].type == "multi")) {
                    integerbtn.style.display = "none"
                    let img_tag = ""
                    let pass_img = ""
                    let pass_tag = ""
                    let message=``
                    let message1=``
                                        let message2=``

                    if(Mydata[que_count].type == "multi"){
                        message1=`<p>Multiple option may be correct</p> <br>`
                        document.getElementById('messagetop').innerHTML=message1

                    } else{
                        message1=``
                     document.getElementById('messagetop').innerHTML=message1

                    }
                    if (Mydata[que_count].queimg) {
                        que_tag = '<span class="ff">' + Mydata[que_count].numb + ". " + `<img src="${Mydata[que_count].queimg}" id="ty"  alt="" >` + '</span>' + '<br>'
                    }
                    else {
                       // document.getElementById("queimg").style.display="none"
                        que_tag = '<span class="ff">' + Mydata[que_count].numb + ". " + Mydata[que_count].question + '</span>' + '<br>'
                    }

                    if (Mydata[que_count].myfile != null) {
                        img_tag = Mydata[que_count].myfile;
                    } else {
                        img_tag = ""
                    }

                    if (Mydata[que_count].passageimg.length!= 0) {
                        pass_img = Mydata[que_count].passageimg;
                        message=`<p>Read the passage and answer questions</p> <br>`
                     document.getElementById('passtop').innerHTML=message
                    } else {
                        pass_img = ""
                        message=``
                    document.getElementById('passtop').innerHTML=message

                        
                    }
                    if (Mydata[que_count].passage.length!= 0) {
                        pass_tag = `
                        <textarea readonly class="form-control" id="pass" 
                        style="width:100%;overflow-y:scroll;height:auto;margin:auto">
                        ${Mydata[que_count].passage}</textarea>`;
                         message=`<p>Read the passage and answer questions</p> <br>`
                     document.getElementById('passtop').innerHTML=message
                  document.getElementById('passage').innerHTML=pass_tag
                  console.log( document.getElementById('passage').innerHTML)

                    } else {
                        pass_tag = ""
                          message=``
                    document.getElementById('passtop').innerHTML=message

                document.getElementById('passage').innerHTML=pass_tag
                                  console.log(pass_tag)


                    }
                    que_text.innerHTML = que_tag
                    if (img_tag == null) {
                        myimgtag.setAttribute("src", img_tag)
                    }
                    else {
                        message=`<p>Read the passage and answer questions</p> <br>`

                        myimgtag.setAttribute("src", img_tag)
                    }
                    if (pass_img.length != 0) {
                        message2=`<p>Read the passage and answer questions</p> <br>`
                    document.getElementById('passtop1').innerHTML=message2

                        mypassimg.setAttribute("src", pass_img)

                    } else {
                       message2=``

                        mypassimg.setAttribute("src", pass_img)
                    document.getElementById('passtop1').innerHTML=message2

                    }

                   
                    let option_tag = `<div class="optiongr">
                 
        <div class="option"  id=0>${Mydata[que_count].option1} </div>
    <div class="option"  id=1>${Mydata[que_count].option2} </div>
    <div class="option"  id=2>${Mydata[que_count].option3} </div>
    <div class="option"  id=3> ${Mydata[que_count].option4} </div>
   
    </div>`;
                    option_list.style.display = "block"
                    integerquestion.style.display = 'none'
                    option_list.innerHTML = option_tag; //adding new div tag inside option_tag 
                    const option = option_list.children[0].querySelectorAll(".option");
                    let obj = {}
                    let h;
                    if ((Mydata[que_count].type == "multi")) {
                        if (myquestions[que_count] == null) {
                            h = []

                        }
                        else {
                            h = myquestions[que_count]
                        }
                        for (let i = 0; i < 4; i++) {

                            option[i].onclick = () => {
                                if (h.includes(option[i].getAttribute('id'))) {
                                    option[i].classList.remove("green")
                                    let index = h.findIndex(elem => elem == option[i].getAttribute('id'))
                                    h.splice(index, 1)
                                }
                                else {
                                    h.push(option[i].getAttribute('id'))
                                    option[i].classList.add("green")
                                    myquestions[que_count] = h
                                    console.log(myquestions[que_count])
                                }
                            }
                        }
                    }
                    else {
                        for (let i = 0; i < 4; i++) {
                            option[i].onclick = () => {
                                myquestions[que_count] = (option[i].getAttribute('id'))
                                for (let j = 0; j < 4; j++) {
                                    if (myquestions[que_count] == option[j].getAttribute('id')) {
                                        option[j].classList.add("green")
                                    }
                                    if (myquestions[que_count] != option[j].getAttribute('id')) {
                                        option[j].classList.remove("green")
                                    }
                                }
                            }
                        }

                    }
                    localStorage.setItem("myquestions", JSON.stringify(myquestions))
                }

                if (Mydata[que_count].type == "integertype") {
                    option_list.style.display = "none"
                    integerquestion.style.display = 'block'
                    integerbtn.style.display = "block"
                
                    que_tag = '<span class="ff">' + Mydata[que_count].numb + ". " + Mydata[que_count].question + '</span>' + '<br>'
                    que_text.innerHTML = que_tag
                    integerbtn.onclick = () => {
                        console.log(integerans.value)
                        myquestions[que_count] = integerans.value
                        localStorage.setItem("myquestions", JSON.stringify(myquestions))
                        console.log(myquestions)
                    }
                }
            }
        }

        function showResult() {
            result()
            console.log("this is result box")
            quiz_box.style.display = 'none'; //hide quiz box
            result_box.classList.add("activeResult"); //show result box
            for (let i = 0; i < Mydata.length; i++) {
                let que_tag = '<span class="ff">' + Mydata[i].numb + ". " + Mydata[i].question + '</span>';
                let img_tag = `<img.src="${Mydata[i].myfiles}" alt="" >`
                let option_tag = `<div class="optiongr">
                   
        <div class="option" id=0>${Mydata[i].option1} </div>
    <div class="option" id=1>${Mydata[i].option2} </div>
    <div class="option" id=2>${Mydata[i].option3} </div>
    <div class="option" id=3> ${Mydata[i].option4} </div>
     
    <textarea class="solutions" style="height:400px;width:500px;"><span> ${Mydata[i].solutions}<span> </textarea>
    </div>`;
                html += que_tag + `<br>` + img_tag + `<br>` + option_tag + `<br>`
            }

            const scoreText = result_box.querySelector(".score_text");
        }

        //-------------------------------------------------scoretext-------------------------------------------

        function result() {
            let my = JSON.parse(localStorage.getItem("myquestions"))
            console.log(myquestions)
            let m = 0
            let pp = 0
            let mymarks=0

            for (let i = 0; i < Mydata.length; i++) {
                let a = []
                let b = []
                let l = 0
                let ll = [];

                //--------------------evaluation of multiple answers questions-------------
                if (Mydata[i].type == "multi") {
                    if (JSON.parse(Mydata[i].answercode)['answer1'] != '') {
                        b.push(JSON.parse(Mydata[i].answercode)['answer1'])
                    }
                    if (JSON.parse(Mydata[i].answercode)['answer2'] != '') {
                        b.push(JSON.parse(Mydata[i].answercode)['answer2'])
                    }
                    if (JSON.parse(Mydata[i].answercode)['answer3'] != '') {
                        b.push(JSON.parse(Mydata[i].answercode)['answer3'])
                    }

                    if (myquestions[i]) {
                        for (let j = 0; j < myquestions[i].length; j++) {
                            ll = myquestions[i]
                            a.push(ll[j])

                        }
                    }
                    for (let t = 0; t < b.length; t++) {
                        for (let j = 0; j < a.length; j++) {
                            if (b[t] == a[j]) {
                                l = l + 1
                            }
                        }

                        if (l == b.length) {
                            if (Mydata[i].postivemarks != 'undefined') {
                              console.log("they are qual")
                              mymarks+=1
                                nn = nn + parseInt(Mydata[i].postivemarks)
                            }
                            else {
                            }
                        } else {
                            if (Mydata[i].negativemarks != 'undefined') {
                                nn = nn - parseInt(Mydata[i].negativemarks)
                            }
                        }
                    }
                }

                //---------------------------Evaluation of integertype questions----------------------------
                if (Mydata[i].type == "integertype") {
                    console.log("Integer evaluation is beggining")
                    if (myquestions[i] == parseInt(Mydata[i].integerans)) {
                        if (typeof (Mydata[i].postivemarks) != 'undefined') {
                            console.log("Integer evaluation is running")
                            pp = pp + parseInt(Mydata[i].positivemarks)
                            mymarks+=1
                            m = m + pp
                        }
                        else {
                            //
                        }
                    } else {
                        if (typeof (Mydata[i].negativemarks) != 'undefined') {
                            m = m - parseInt(Mydata[i].negativemarks)
                        }
                    }
                }
                //-------------------------------------------------------------------------------------------

                //---------------------------Evaluation of multiplechoice questions--------------------------
                if (Mydata[i].type == "multichoice") {
                    if (myquestions[i] != null) {
                        if (myquestions[i] == JSON.parse(Mydata[i].answercode)['answer1']) {
                            if (typeof (Mydata[i].postivemarks) != 'undefined') {
                                m = m + parseInt(Mydata[i].postivemarks);
                               mymarks+=1
                                console.log("Marks is increased")
                            }
                            else {
                                //
                            }
                        } else {
                            if (typeof (Mydata[i].negativemarks) != 'undefined') {
                                m = m - parseInt(Mydata[i].negativemarks)
                                console.log("updated marks")
                            }
                        }
                    }
                    tm = m + nn + pp
                    console.log(tm)
                }

                //----------------------------------------------------------------------------
            }
            fs = tm + pp
            document.getElementById('marks').value = mymarks
            console.log("yur score is" + mymarks)
        }

        //-------------------------------using ajax to send myquestions to server------------------------------

        $(document).ready(function () {

            $("#myform").on("submit", function (e) {
                e.preventDefault()
                var studentname = $("#studentname").val()
                var quizname = $("#quizname").val()
                var regno = $("#regno").val()
                var marks = $("#marks").val()
                var responses = myquestions
                console.log("this is the marks")
                console.log(marks)
                $.ajax({
                    type: "POST",
                    url: '/newquiz4result',
                    data: { studentname: studentname, quizname: quizname, regno: regno, responses: JSON.stringify(myquestions), marks: marks },
                    success: function (response) {
                        alert(response)
                        document.getElementById("myform1").submit()
                       // document.getElementById("myform").submit()


                    }
                });
            });
        });
        let count;
        let b = localStorage.getItem('storagekey')
        if (b == null) {
            count = Mydata[1].time
        }
        else {
            count = b
        }
        startTimer(count);
        document.addEventListener("visibilitychange", function () {
            document.title = document.visibilityState;
            if (document.title == 'hidden') {
                clearInterval(counter)
                showResult()
            }
        })

        function startTimer(count) {
            counter = setInterval(timer, 1000);
            function timer() {
                //window.addEventListener("beforeunload", function (e) {
                //var confirmationMessage = "\o/";

                //(e || window.event).returnValue = confirmationMessage; //Gecko + IE
                //return confirmationMessage;                            //Webkit, Safari, Chrome
                //});
                const sec = parseInt(count, 10);
                let hours = Math.floor(count / 3600); // get hours
                let minutes = Math.floor((count - (hours * 3600)) / 60); // get minutes
                let seconds = sec - (hours * 3600) - (minutes * 60);
                timeCount.textContent = hours + ":" + minutes + ":" + seconds; //changing the value of timeCount with time value
                count--; //decrement the time value
                localStorage.setItem('storagekey', count)
                count = localStorage.getItem('storagekey')
                if (count < 9) { //if timer is less than 9
                    let addZero = timeCount.textContent;
                    timeCount.textContent = "0" + addZero; //add a 0 before time value
                }
                if (count < 0) { //if timer is less than 0
                    clearInterval(counter); //clear counter
                    timeText.textContent = "Time Off"; //change the time text to time off
                    localStorage.removeItem('storagekey');
                    document.getElementById('myform').style.display = "block"
                    document.getElementById('mysect').style.display = "none"
                    document.getElementById('myfoot').style.display = "none"
                    document.getElementById('myquiz').style.display = "none"
                    document.getElementById("mysections").style.display = "none"
                    option_list.style.display = "none"
                    showResult()
                    solution_btn.classList.add("showsolutionbtn")
                    next_btn.classList.add("show"); //show the next button if user selected any option
                }
            }
        }
        function queCounter(index) {
           // let totalQueCounTag = '<span><p>' + index + '</p> of <p>' + Mydata.length + '</p> Questions</span>';
           // bottom_ques_counter.innerHTML = totalQueCounTag;  //adding new span tag inside bottom_ques_counter
        }

        function changeoption(id){
            changed(id)
                            let a = []

    let myanswers = JSON.parse(localStorage.getItem("myquestions"))


que_count=id
              que_numb = que_count + 1
                   
                    g = myanswers[que_count]
                const option_list = document.querySelector(".option_list");
                    const option = option_list.children[0].querySelectorAll(".option");
                    console.log(g)


 if (Array.isArray(myanswers[que_count])) {
                        for (let i = 0; i < myanswers[que_count].length; i++) {
                            a.push(myanswers[que_count][i]);
                            option[a[i]].classList.add('green')
                            console.log("dfgdsg3")
                        }
                    }
                    else {
                        if (option[g]) {


                            option[g].classList.add('green')
                        }
                    }

        }

//console.log(html)


      ///this isi the doubtful bracket kindly refer it again
        //-------------------------------------------------------------------------------------------------------



        // if (myquestions[i] == actualans.answer1) {
        //console.log("matched")
        //  userScore1 = userScore1 + 1




        // document.getElementById("myform").innerHTML = ``


        //             for (let i = 0; i < myquestions.length; i++) {
        //                 document.getElementById("myform").innerHTML += `<input type="number" name=Myname value=${myquestions[i]}><br>
        // `

        //             }
        // document.getElementById("myform").innerHTML += `<input type="text" name=na value={{table2}}>`
        // document.getElementById("myform").innerHTML += `<input type="number" name=registation value={{reg}}>`
        // document.getElementById("myform").innerHTML += `<input type="number" name=marks value=${userScore1}>`
        // document.getElementById("myform").innerHTML += `<input type="text" name=studentname value={{name2}}>`
        // document.getElementById("myform").submit()

    </script>
</body>

</html>